import{x as j,a as o,t as y,p as e,C as N,L as P}from"./chunk-PVWAREVJ-gVtuFcjs.js";import{u as v}from"./AuthContext-D4lhteYI.js";import{a as S}from"./api-8LSux9jW.js";const F=j(function(){const[a,p]=o.useState(!1),[s,g]=o.useState({username:"",email:"",password:"",retypePassword:""}),[m,r]=o.useState(null),l=y(),{login:f,isLoggedIn:u}=v();o.useEffect(()=>{u&&l("/logout",{replace:!0})},[u,l]);const h=()=>{p(t=>!t),r(null)},n=t=>{g(i=>({...i,[t.target.name]:t.target.value}))},w=async t=>{if(t.preventDefault(),r(null),a){if(!s.username||!s.email||!s.password||!s.retypePassword){r("All fields are required");return}if(s.password!==s.retypePassword){r("Passwords do not match");return}if(s.password.length<6){r("Password must be at least 6 characters");return}}const i=a?"/signup":"/login",x=a?{username:s.username,email:s.email,password:s.password}:{email:s.email,password:s.password};try{const d=await S(i,{method:"POST",body:JSON.stringify(x)}),c=await d.json();if(!d.ok){r(c.error||(a?"Signup failed":"Login failed"));return}f(c.token,c.user),await new Promise(b=>setTimeout(b,100)),l("/",{replace:!0})}catch{r("Network error. Please try again.")}};return e.jsx("div",{className:"container align-self-center page-transition",children:e.jsx("div",{className:"row justify-content-center",children:e.jsx("div",{className:"col-12 col-md- col-lg-6",children:e.jsxs(N,{className:"card border-0 bg-dark-subtle p-4 rounded-4",onSubmit:w,children:[e.jsxs("div",{className:"card-header border-0 bg-transparent",children:[e.jsx("p",{className:"display-5 mb-3",children:a?"Sign Up":"Login"}),e.jsx("p",{className:"fs-5 my-0",children:a?"Please enter a unique email and strong password":"Please login or sign up to access your dashboard"})]}),e.jsxs("div",{className:"card-body",children:[m&&e.jsx("div",{className:"alert alert-danger",children:m}),a&&e.jsxs("div",{className:"form-floating mb-3",children:[e.jsx("input",{type:"text",className:"form-control",id:"floatingUsername",name:"username",placeholder:"Username",value:s.username,onChange:n,required:!0}),e.jsx("label",{htmlFor:"floatingUsername",children:"Username"})]}),e.jsxs("div",{className:"form-floating mb-3",children:[e.jsx("input",{type:"email",className:"form-control",id:"floatingInput",name:"email",placeholder:"name@example.com",value:s.email,onChange:n,required:!0}),e.jsx("label",{htmlFor:"floatingInput",children:"Email Address"})]}),e.jsxs("div",{className:"form-floating mb-3",children:[e.jsx("input",{type:"password",className:"form-control",id:"floatingPassword",name:"password",placeholder:"Password",value:s.password,onChange:n,required:!0}),e.jsx("label",{htmlFor:"floatingPassword",children:"Password"})]}),a&&e.jsxs("div",{className:"form-floating mb-3",children:[e.jsx("input",{type:"password",className:"form-control",id:"floatingRetypePassword",name:"retypePassword",placeholder:"Retype Password",value:s.retypePassword,onChange:n,required:!0}),e.jsx("label",{htmlFor:"floatingRetypePassword",children:"Retype Password"})]}),e.jsxs("div",{className:"card-footer border-0 bg-transparent p-0 d-flex align-items-center",children:[e.jsx(P,{to:"/forgot-password",children:"Forgot Password"}),e.jsx("button",{className:`ms-auto btn btn-${a?"danger":"primary"}`,type:"button",onClick:h,children:a?"Cancel":"Sign Up"}),e.jsx("button",{className:"btn btn-success ms-2",type:"submit",children:a?"Submit":"Login"})]})]})]})})})})});export{F as default};
